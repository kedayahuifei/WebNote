<%- include header.ejs%>

<div class="text-center page-title">新用户注册</div>
<div class="container">
    <div clas="row">
        <div class="col-xs-4 col-xs-offset-4">
            <form id="registerForm" method="post">
                <label id ="usernameError" ></label>
                <div class="form-group">
                    <input type="text" id ="username" class="form-control" name ="username" placeholder="用户名">
                </div>
                <div class="form-group">
                    <input type="password" id ="password" class="form-control" name ="password" placeholder="密码">
                </div>
                <div class="form-group">
                    <input type="password" id ="passwordRepeat" class="form-control" name ="passwordRepeat" placeholder="确认密码">
                </div>
                <button type="submit" class="btn btn-default center-block">注册</button>
            </form>

            <!--<script src="/jquery_validation_1.14.0/lib/jquery.js"></script>-->
            <script src="/jquery_validation_1.14.0/dist/jquery.validate.js"></script>
            <script src="/jquery_validation_1.14.0/dist/localization/messages_zh.js"></script>
            <script>
                $("#username").change(function(){
                    var username = $("#username").val();
                    $.post('/checkUsername',{user:username},function(data,status){
                        $("#usernameError").html(data);
                    });
                });
                $().ready(function() {
                    jQuery.validator.addMethod("usernameCheck", function(value, element, param) {
                        var length = value.length;
                        if(length<3||length>20)
                            return false;
                        var checkout = /^[a-zA-Z0-9_]{1,}$/;
                        return value.match(checkout);
                    }, $.validator.format("请确保是字母、数字、下划线的组合，长度3-20个字符"));
                    jQuery.validator.addMethod("passwordCheck", function(value, element, param) {
                        var length = value.length;
                        if(length<6)
                            return false;
                        var checkout = /(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])[a-zA-Z0-9]/;
                        return value.match(checkout);
                    }, $.validator.format("请确保长度不能少于6，必须同时包含数字、小写字母、大写字母。"));
                    $("#registerForm").validate({
                        rules: {
                            username: "required",
                            password: "required",
                            username: "usernameCheck",
                            password: "passwordCheck",
                            passwordRepeat: {
                                required: true,
                                minlength: 6,
                                equalTo: "#password"
                            }
                        },
                        messages: {
                            passwordRepeat: {
                                required: "请输入密码",
                                minlength: "密码长度不能小于 5 个字母",
                                equalTo: "两次密码输入不一致"
                            }
                        }
                    });
                });
            </script>
        </div>
    </div>
</div>

<%- include footer.ejs%>